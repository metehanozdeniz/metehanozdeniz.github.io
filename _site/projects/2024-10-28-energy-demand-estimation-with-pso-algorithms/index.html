<!DOCTYPE html>
<html lang="tr"><!--
 __    __     ______     ______   ______     __  __     ______     __   __    
/\ "-./  \   /\  ___\   /\__  _\ /\  ___\   /\ \_\ \   /\  __ \   /\ "-.\ \   
\ \ \-./\ \  \ \  __\   \/_/\ \/ \ \  __\   \ \  __ \  \ \  __ \  \ \ \-.  \  
 \ \_\ \ \_\  \ \_____\    \ \_\  \ \_____\  \ \_\ \_\  \ \_\ \_\  \ \_\\"\_\ 
  \/_/  \/_/   \/_____/     \/_/   \/_____/   \/_/\/_/   \/_/\/_/   \/_/ \/_/

Powered by Metehan Özdeniz <https://metehanozdeniz.com/>
-->







<head>
  






  
    
<!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Energy Demand Estimation with PSO Algorithm | Metehan Özdeniz</title>
<meta name="generator" content="Jekyll v3.9.3" />
<meta property="og:title" content="Energy Demand Estimation with PSO Algorithm" />
<meta name="author" content="Metehan Özdeniz" />
<meta property="og:locale" content="tr_TR, en_US" />
<meta name="description" content="PSO algoritması ile enerji talebi tahmini" />
<meta property="og:description" content="PSO algoritması ile enerji talebi tahmini" />
<link rel="canonical" href="http://localhost:4000/projects/2024-10-28-energy-demand-estimation-with-pso-algorithms/" />
<meta property="og:url" content="http://localhost:4000/projects/2024-10-28-energy-demand-estimation-with-pso-algorithms/" />
<meta property="og:site_name" content="Metehan Özdeniz" />
<meta property="og:image" content="http://localhost:4000/assets/img/projects/pso/PSO.gif" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2024-10-28T00:00:00+03:00" />
<meta name="twitter:card" content="summary_large_image" />
<meta property="twitter:image" content="http://localhost:4000/assets/img/projects/pso/PSO.gif" />
<meta property="twitter:title" content="Energy Demand Estimation with PSO Algorithm" />
<meta name="twitter:site" content="@metehanozdeniz" />
<meta name="twitter:creator" content="@metehanozdeniz" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Metehan Özdeniz"},"dateModified":"2024-10-29T00:00:00+03:00","datePublished":"2024-10-28T00:00:00+03:00","description":"PSO algoritması ile enerji talebi tahmini","headline":"Energy Demand Estimation with PSO Algorithm","image":"http://localhost:4000/assets/img/projects/pso/PSO.gif","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/projects/2024-10-28-energy-demand-estimation-with-pso-algorithms/"},"publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"http://localhost:4000/assets/img/pp.jpg"},"name":"Metehan Özdeniz"},"url":"http://localhost:4000/projects/2024-10-28-energy-demand-estimation-with-pso-algorithms/"}</script>
<!-- End Jekyll SEO tag -->


  

  
    <meta name="keywords" content="Optimization Algorithms,PSO Algorithm,Particle Swarm Optimization Algorithm,Parçacık Sürü Optimizasyonu Algoritması">
  



  <meta name="theme-color" content="rgb(0,0,0)">


<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta http-equiv="x-ua-compatible" content="ie=edge">

<meta name="mobile-web-app-capable" content="yes">

<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-title" content="Metehan Özdeniz">
<meta name="apple-mobile-web-app-status-bar-style" content="default">

<meta name="application-name" content="Metehan Özdeniz">

<meta name="generator" content="Hydejack v9.2.0" />


<link rel="alternate" href="http://localhost:4000/projects/2024-10-28-energy-demand-estimation-with-pso-algorithms/" hreflang="tr-tr, en-us">

<link type="application/atom+xml" rel="alternate" href="http://localhost:4000/feed.xml" title="Metehan Özdeniz" />


<link rel="shortcut icon"    href="/assets/icons/favicon.ico">
<link rel="apple-touch-icon" href="/assets/icons/icon-192x192.png">

<link rel="manifest" href="/assets/site.webmanifest">




  <link rel="dns-prefetch" href="https://www.google-analytics.com">


<link rel="preload" href="/assets/img/swipe.svg" as="image" id="_hrefSwipeSVG">






  <link rel="stylesheet" href="https://unpkg.com/applause-button/dist/applause-button.css">
  <script src="https://unpkg.com/applause-button/dist/applause-button.js"></script>



  <link rel="stylesheet" href="/assets/css/lightbox.css">


<script>((r,a)=>{function d(e,t,n,o){e.addEventListener?e.addEventListener(t,n,o):e.attachEvent?e.attachEvent("on"+t,n):e["on"+t]=n}r.loadJS=function(e,t){var n=a.createElement("script"),e=(n.src=e,t&&d(n,"load",t,{once:!0}),a.scripts[0]);return e.parentNode.insertBefore(n,e),n},r._loaded=!1,r.loadJSDeferred=function(e,t){var n=a.createElement("script");function o(){r._loaded=!0,t&&d(n,"load",t,{once:!0});var e=a.scripts[0];e.parentNode.insertBefore(n,e)}return n.src=e,r._loaded?o():d(r,"load",o,{once:!0}),n},r.setRel=r.setRelStylesheet=function(e){d(a.getElementById(e),"load",function(){this.rel="stylesheet"},{once:!0})}})(window,document);
!function(a){"use strict";var b=function(b,c,d){function e(a){return h.body?a():void setTimeout(function(){e(a)})}function f(){i.addEventListener&&i.removeEventListener("load",f),i.media=d||"all"}var g,h=a.document,i=h.createElement("link");if(c)g=c;else{var j=(h.body||h.getElementsByTagName("head")[0]).childNodes;g=j[j.length-1]}var k=h.styleSheets;i.rel="stylesheet",i.href=b,i.media="only x",e(function(){g.parentNode.insertBefore(i,c?g:g.nextSibling)});var l=function(a){for(var b=i.href,c=k.length;c--;)if(k[c].href===b)return a();setTimeout(function(){l(a)})};return i.addEventListener&&i.addEventListener("load",f),i.onloadcssdefined=l,l(f),i};"undefined"!=typeof exports?exports.loadCSS=b:a.loadCSS=b}("undefined"!=typeof global?global:this);
!function(a){if(a.loadCSS){var b=loadCSS.relpreload={};if(b.support=function(){try{return a.document.createElement("link").relList.supports("preload")}catch(b){return!1}},b.poly=function(){for(var b=a.document.getElementsByTagName("link"),c=0;c<b.length;c++){var d=b[c];"preload"===d.rel&&"style"===d.getAttribute("as")&&(a.loadCSS(d.href,d,d.getAttribute("media")),d.rel=null)}},!b.support()){b.poly();var c=a.setInterval(b.poly,300);a.addEventListener&&a.addEventListener("load",function(){b.poly(),a.clearInterval(c)}),a.attachEvent&&a.attachEvent("onload",function(){a.clearInterval(c)})}}}(this);
!function(w) {
  w._baseURL = '/';
  w._publicPath = '/assets/js/';
  w._noPushState = false;
  w._noDrawer = false;
  w._noNavbar = false;
  w._noToc = false;
  w._noSearch = false;
  w._search = {
    DATA_URL: '/assets/sitedata.json?no-cache',
    STORAGE_KEY: 'mini-search/',
    INDEX_KEY: 'index--2024-10-28T22:17:04+03:00',
  };
  w._clapButton = true;
}(window);</script>


<script async src="/assets/bower_components/MathJax/es5/tex-mml-chtml.js" id="_MathJax"></script>


<!--[if gt IE 8]><!---->

  




<link rel="stylesheet" href="/assets/css/hydejack-9.2.0.css" id="_stylePreload">
<link rel="stylesheet" href="/assets/icomoon/style.css" id="_iconsPreload">




  <style id="_pageStyle">

html{--accent-color: rgb(79,177,186);--accent-color-faded: rgba(79,177,186,0.5);--accent-color-highlight: rgba(79,177,186,0.1);--accent-color-darkened: #409ba3;--theme-color: rgb(0,0,0);--dark-mode-body-bg: #2d2d2d;--dark-mode-border-color: #393939}

</style>


<!--<![endif]-->




<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-CB4287NP8H"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-CB4287NP8H');
</script>

</head>

<body class="no-break-layout">
  

<script>
  window._sunrise = 6;
  window._sunset =  18;
  ((e,s)=>{var d="light-mode",a="dark-mode",o=(new Date).getHours();"matchMedia"in e&&e.matchMedia("(prefers-color-scheme)")||(e=(o=o<=e._sunrise||o>=e._sunset?a:d)==a?d:a,s.body.classList.add(o),s.body.classList.remove(e))})(window,document);

</script>



<hy-push-state
  id="_pushState"
  replace-selector="#_main"
  link-selector="a[href]:not([href^='/assets/']):not(.external):not(.no-push-state)"
  script-selector="script"
  duration="500"
  hashchange
>
  
  
  <div id="_navbar" class="navbar fixed-top">
  <div class="content">
    <span class="sr-only">Jump to:</span>
    <div class="nav-btn-bar">
      <a id="_menu" class="nav-btn no-hover" href="#_drawer--opened">
        <span class="sr-only">Navigation</span>
        <span class="icon-menu"></span>
      </a>
      <div class="nav-span"></div>
    </div>
  </div>
</div>
<hr class="sr-only" hidden />

  <main
  id="_main"
  class="content layout-post"
  role="main"
>
  <nav id="breadcrumbs" class="screen-only"><ul>
  
  
    <li><a href="/">Home</a></li>
    
      <li>
        
          <span>/</span>
          
          
          <a href="/projects/">projects</a>
        
      </li>
    
      <li>
        
          <span>/</span>
          <span>2024-10-28-energy-demand-estimation-with-pso-algorithms</span>
        
      </li>
    
  
</ul></nav>
  











<article id="post-projects-energy-demand-estimation-with-pso-algorithms" class="page post mb6" role="article">
  <header>
    <h1 class="post-title flip-project-title">
      
        Energy Demand Estimation with PSO Algorithm
      
    </h1>

    <div class="post-date">
      
      <span class="ellipsis mr1">
        <time datetime="2024-10-28T00:00:00+03:00">28 Oct 2024</time> Categorized under <a href="/projects/" class="flip-title">My Projects</a> 
           
          <span class="clap-count" data-url="http://localhost:4000/projects/2024-10-28-energy-demand-estimation-with-pso-algorithms/"></span>
        
      
      </span>
      
        
          
          
          
            
            
            <span class="ellipsis" data-tippy-content="Last modified at: 29 Oct 2024">
              <span class="sr-only">Last modified at:</span>
              <span class="icon-history"></span>
              <time datetime="2024-10-29T00:00:00+03:00">29-10-2024</time>
            </span>
          
        
      
    </div>

    
    
      
        <div class="img-wrapper lead aspect-ratio sixteen-nine flip-project-img">
          
            


<img
  
    src="/assets/img/projects/pso/PSO.gif"
  
  alt="Energy Demand Estimation with PSO Algorithm"
  
  
  width="864"
  height="486"
  loading="lazy"
/>

          
        </div>
      
      
    

    



  
    <p class="note-sm" >
      PSO algoritması ile enerji talebi tahmini

    </p>
  


  </header>

  
    <ul id="markdown-toc">
  <li><a href="#linear-model" id="markdown-toc-linear-model">Linear Model</a></li>
  <li><a href="#download-and-install-libraries" id="markdown-toc-download-and-install-libraries">Download and install libraries</a></li>
  <li><a href="#import-the-necessary-libraries" id="markdown-toc-import-the-necessary-libraries">Import the necessary libraries</a></li>
  <li><a href="#dataset" id="markdown-toc-dataset">Dataset</a></li>
  <li><a href="#load-data" id="markdown-toc-load-data">Load Data</a></li>
  <li><a href="#describe-the-dataset" id="markdown-toc-describe-the-dataset">Describe the dataset</a></li>
  <li><a href="#graphical-analysis-of-data" id="markdown-toc-graphical-analysis-of-data">Graphical Analysis of Data</a></li>
  <li><a href="#split-data" id="markdown-toc-split-data">Split Data</a></li>
  <li><a href="#pso-algorithm" id="markdown-toc-pso-algorithm">PSO Algorithm</a>    <ul>
      <li><a href="#fitness-function" id="markdown-toc-fitness-function">Fitness Function</a></li>
    </ul>
  </li>
  <li><a href="#create-pso-model" id="markdown-toc-create-pso-model">Create PSO Model</a></li>
  <li><a href="#run-pso" id="markdown-toc-run-pso">Run PSO</a></li>
</ul>
<p>Bu projede 1979 – 2015 yıllarına ait veriler kullanılarak Türkiye’nin enerji talebini PSO algoritması ile tahmin eden doğrusal bir tahmin modeli geliştirilmiştir.</p>

<h1 id="linear-model">Linear Model</h1>

\[E_{lineer}=w_1*X_1+w_2*X_2+w_3*X_3+w_4*X_4+w_5\]

<ul>
  <li><strong>X1</strong> : GSYH</li>
  <li><strong>X2</strong> : Nüfus</li>
  <li><strong>X3</strong> : İthalat</li>
  <li><strong>X4</strong> : İhracat</li>
  <li>
    <p><strong>Y</strong> : Enerji Talebi</p>
  </li>
  <li>weights = [w1, w2, w3, w4, w5]</li>
</ul>

<h1 id="download-and-install-libraries">Download and install libraries</h1>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>pip <span class="nb">install </span>matplotlib
<span class="nv">$ </span>pip <span class="nb">install </span>numpy
<span class="nv">$ </span>pip <span class="nb">install </span>pandas
<span class="nv">$ </span>pip <span class="nb">install </span>seaborn
</code></pre></div></div>

<h1 id="import-the-necessary-libraries">Import the necessary libraries</h1>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">pso</span> <span class="kn">import</span> <span class="n">PSO</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="n">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="n">pd</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="n">sns</span>
</code></pre></div></div>

<h1 id="dataset">Dataset</h1>
<ul>
  <li><a href="/assets/datasets/dataset.csv">dataset</a></li>
</ul>

<h1 id="load-data">Load Data</h1>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s">"dataset.csv"</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">print</span><span class="p">(</span><span class="n">data</span><span class="p">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
</code></pre></div></div>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    Yıl  GSYH   Nüfus  İthalat  İhracat  Enerji_Talebi
0  1979    81  43.530     5.07     2.26          30.25
1  1980    68  44.438     7.91     2.91          31.45
2  1981    71  45.540     8.93     4.70          31.71
3  1982    64  46.688     8.84     5.75          33.70
4  1983    60  47.864     9.24     5.73          35.68
</code></pre></div></div>

<h1 id="describe-the-dataset">Describe the dataset</h1>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">print</span><span class="p">(</span><span class="n">data</span><span class="p">.</span><span class="n">describe</span><span class="p">())</span>
</code></pre></div></div>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>               Yıl        GSYH      Nüfus     İthalat     İhracat  Enerji_Talebi
count    37.000000   37.000000  37.000000   37.000000   37.000000      37.000000
mean   1997.000000  296.405405  62.397973   78.330000   49.741351      70.097297
std      10.824355  265.358820  10.533688   82.339139   52.341555      28.906369
min    1979.000000   59.000000  43.530000    5.070000    2.260000      30.250000
25%    1988.000000   90.000000  53.715000   14.340000   11.620000      47.290000
50%    1997.000000  181.000000  62.697000   41.400000   26.260000      70.200000
75%    2006.000000  400.000000  71.789000  139.580000   85.530000      93.150000
max    2015.000000  820.000000  77.695000  251.650000  157.610000     128.810000
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">print</span><span class="p">(</span><span class="n">data</span><span class="p">.</span><span class="n">shape</span><span class="p">)</span>
</code></pre></div></div>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>(37, 6)
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">print</span><span class="p">(</span><span class="n">data</span><span class="p">.</span><span class="n">info</span><span class="p">())</span>
</code></pre></div></div>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>RangeIndex: 37 entries, 0 to 36
Data columns (total 6 columns):
 #   Column         Non-Null Count  Dtype  
---  ------         --------------  -----  
 0   Yıl            37 non-null     int64  
 1   GSYH           37 non-null     int64  
 2   Nüfus          37 non-null     float64
 3   İthalat        37 non-null     float64
 4   İhracat        37 non-null     float64
 5   Enerji_Talebi  37 non-null     float64
</code></pre></div></div>

<h1 id="graphical-analysis-of-data">Graphical Analysis of Data</h1>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">sns</span><span class="p">.</span><span class="n">pairplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">diag_kind</span><span class="o">=</span><span class="s">'kde'</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s">'Enerji_Talebi'</span><span class="p">,</span><span class="n">palette</span><span class="o">=</span><span class="s">'copper'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></div>
<p><img src="/assets/img/projects/pso/energy_demand_estimation_sns_plot.png" alt="energy_demand_estimation_sns_plot" /></p>

<h1 id="split-data">Split Data</h1>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">X</span> <span class="o">=</span> <span class="n">data</span><span class="p">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">].</span><span class="n">values</span> <span class="c1"># Features
</span><span class="n">Y</span> <span class="o">=</span> <span class="n">data</span><span class="p">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="o">-</span><span class="mi">1</span><span class="p">].</span><span class="n">values</span> <span class="c1"># Target
</span></code></pre></div></div>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">print</span><span class="p">(</span><span class="n">X</span><span class="p">.</span><span class="n">shape</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">Y</span><span class="p">.</span><span class="n">shape</span><span class="p">)</span>
</code></pre></div></div>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>(37, 4)
(37,)
</code></pre></div></div>

<h1 id="pso-algorithm">PSO Algorithm</h1>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># file: "pso.py"
################################################################################
#                                                                              #
#                    PSO (PARTICLE SWARM OPTIMIZATION)                         #
#                    PYTHON 3.13.0                                             #
#                                                                              #
################################################################################
</span>
<span class="c1">#######################   IMPORT DEPENDENCIES   ################################
</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="n">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="n">plt</span>

<span class="c1">###########################  PARTICLE CLASS  ###################################
</span>

<span class="k">class</span> <span class="nc">Particle</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">X0</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">bound</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="s">"""

        PARAMETERS:

        n: TOTAL DIMENSIONS

        vmax: MAXIMUM LIMITED VELOCITY OF A PARTICLE

        X0: INITIAL POSITION OF PARTICLE SPECIFIED BY USER

        bound: AXIS BOUND FOR EACH DIMENSION

        ################ EXAMPLE #####################

        If X = [x,y,z], n = 3 and if
        bound = [(-5,5),(-1,1),(0,5)]
        Then, x∈(-5,5); y∈(-1,1); z∈(0,5)

        ##############################################

        X: PARTICLE POSITION OF SHAPE (n,1)

        V: PARTICLE VELOCITY OF SHAPE (n,1)

        pbest: PARTICLE'S OWN BEST POSITION OF SHAPE (n,1)

        """</span>

        <span class="c1"># IF INITIAL POSITION 'X0' IS NOT SPECIFIED THEN DO RANDOM INITIALIZATION OF 'X'
</span>
        <span class="k">if</span> <span class="n">X0</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="p">.</span><span class="n">X</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="n">rand</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="p">.</span><span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">array</span><span class="p">(</span><span class="n">X0</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s">"float64"</span><span class="p">).</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">bound</span> <span class="o">=</span> <span class="n">bound</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">n</span> <span class="o">=</span> <span class="n">n</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">vmax</span> <span class="o">=</span> <span class="n">vmax</span>

        <span class="s">"""

        np.random.rand() ∈ (0,1)
        
        THEREFORE 2*vmax*np.random.rand() ∈ (0,2*vmax)
        
        THUS, V = 2*vmax*np.random.rand() - vmax ∈ (-vmax,vmax)
        
        """</span>

        <span class="bp">self</span><span class="p">.</span><span class="n">V</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">vmax</span> <span class="o">*</span> <span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="n">rand</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="n">vmax</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">clip_X</span><span class="p">()</span>

        <span class="c1"># INITIALIZE 'pbest' WITH A COPY OF 'X'
</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">pbest</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">X</span><span class="p">.</span><span class="n">copy</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">clip_X</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># IF BOUND IS SPECIFIED THEN CLIP 'X' VALUES SO THAT THEY ARE IN THE SPECIFIED RANGE
</span>
        <span class="k">if</span> <span class="bp">self</span><span class="p">.</span><span class="n">bound</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">n</span><span class="p">):</span>
                <span class="n">xmin</span><span class="p">,</span> <span class="n">xmax</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">bound</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                <span class="bp">self</span><span class="p">.</span><span class="n">X</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">clip</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">X</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">xmin</span><span class="p">,</span> <span class="n">xmax</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">update_velocity</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">c1</span><span class="p">,</span> <span class="n">c2</span><span class="p">,</span> <span class="n">gbest</span><span class="p">):</span>
        <span class="s">"""

        PARAMETERS:

        w: INERTIA WEIGHT

        c1: INDIVIDUAL COGNITIVE PARAMETER

        c2: SOCIAL LEARNING PARAMETER

        gbest: GLOBAL BEST POSITION (BEST POSITION IN GROUP) OF SHAPE (n,1)

        ACTION:

        UPDATE THE PARTICLE'S VELOCITY

        """</span>

        <span class="bp">self</span><span class="p">.</span><span class="n">clip_X</span><span class="p">()</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">V</span> <span class="o">=</span> <span class="n">w</span> <span class="o">*</span> <span class="bp">self</span><span class="p">.</span><span class="n">V</span>  <span class="c1"># PARTICLE'S PREVIOUS MOTION
</span>        <span class="bp">self</span><span class="p">.</span><span class="n">V</span> <span class="o">+=</span> <span class="n">c1</span> <span class="o">*</span> <span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="n">rand</span><span class="p">()</span> <span class="o">*</span> <span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">pbest</span> <span class="o">-</span> <span class="bp">self</span><span class="p">.</span><span class="n">X</span><span class="p">)</span>  <span class="c1"># COGNITIVE VELOCITY
</span>        <span class="bp">self</span><span class="p">.</span><span class="n">V</span> <span class="o">+=</span> <span class="n">c2</span> <span class="o">*</span> <span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="n">rand</span><span class="p">()</span> <span class="o">*</span> <span class="p">(</span><span class="n">gbest</span> <span class="o">-</span> <span class="bp">self</span><span class="p">.</span><span class="n">X</span><span class="p">)</span>  <span class="c1"># SOCIAL VELOCITY
</span>        <span class="bp">self</span><span class="p">.</span><span class="n">V</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">clip</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">V</span><span class="p">,</span> <span class="o">-</span><span class="bp">self</span><span class="p">.</span><span class="n">vmax</span><span class="p">,</span> <span class="bp">self</span><span class="p">.</span><span class="n">vmax</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">update_position</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="s">"""

        ACTION:

        UPDATE THE PARTICLE'S POSITION

        """</span>

        <span class="bp">self</span><span class="p">.</span><span class="n">X</span> <span class="o">+=</span> <span class="bp">self</span><span class="p">.</span><span class="n">V</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">clip_X</span><span class="p">()</span>


<span class="c1">###########################  PSO CLASS  ####################################
</span>

<span class="k">class</span> <span class="nc">PSO</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">fitness</span><span class="p">,</span>
        <span class="n">P</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span>
        <span class="n">n</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
        <span class="n">w</span><span class="o">=</span><span class="mf">0.72984</span><span class="p">,</span>
        <span class="n">c1</span><span class="o">=</span><span class="mf">2.8</span><span class="p">,</span>
        <span class="n">c2</span><span class="o">=</span><span class="mf">2.05</span><span class="p">,</span>
        <span class="n">Tmax</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span>
        <span class="n">vmax</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
        <span class="n">X0</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
        <span class="n">bound</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
        <span class="n">update_w</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
        <span class="n">update_c1</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
        <span class="n">update_c2</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
        <span class="n">update_vmax</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
        <span class="n">plot</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
        <span class="nb">min</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
        <span class="n">verbose</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="s">"""

        THE SYMBOLS OR NOTATIONS WERE TAKEN FROM [1] AND [2]

        PARAMETERS:

        fitness: A FUNCTION WHICH EVALUATES COST (OR THE FITNESS) VALUE

        P: POPULATION SIZE

        n: TOTAL DIMENSIONS

        w: INERTIA WEIGHT (CAN BE A CONSTANT OR CHANGES WITH ITERATION BASED ON 'update_w' VALUE)

        update_w: BOOL VALUE (TRUE WHEN 'w' CHANGES WITH ITERATION AND FALSE IF 'w' IS CONSTANT)

        c1: INDIVIDUAL COGNITIVE PARAMETER (CAN BE A CONSTANT OR CHANGES WITH ITERATION BASED ON 'update_c1' VALUE)

        update_c1: BOOL VALUE (TRUE WHEN 'c1' CHANGES WITH ITERATION AND FALSE IF 'c1' IS CONSTANT)

        c2: SOCIAL LEARNING PARAMETER (CAN BE A CONSTANT OR CHANGES WITH ITERATION BASED ON 'update_c2' VALUE)

        update_c2: BOOL VALUE (TRUE WHEN 'c2' CHANGES WITH ITERATION AND FALSE IF 'c2' IS CONSTANT)

        Tmax: MAXIMUM ITERATION

        vmax: MAXIMUM LIMITED VELOCITY OF A PARTICLE (CAN BE A CONSTANT OR CHANGES WITH ITERATION BASED ON 'update_vmax' VALUE)

        update_vmax: BOOL VALUE (TRUE WHEN 'vmax' CHANGES WITH ITERATION AND FALSE IF 'vmax' IS CONSTANT)

        X0: INITIAL POSITION OF PARTICLE SPECIFIED BY USER

        bound: AXIS BOUND FOR EACH DIMENSION

        ################ EXAMPLE #####################

        If X = [x,y,z], n = 3 and if
        bound = [(-5,5),(-1,1),(0,5)]
        Then, x∈(-5,5); y∈(-1,1); z∈(0,5)

        ##############################################

        plot: BOOL VALUE (TRUE IF PLOT BETWEEN GLOBAL FITNESS (OR COST) VALUE VS ITERATION IS NEEDED ELSE FALSE)

        min: BOOL VALUE (TRUE FOR 'MINIMIZATION PROBLEM' AND FALSE FOR 'MAXIMIZATION PROBLEM')

        verbose: BOOL VALUE (TRUE IF PRINTING IS REQUIRED TO SHOW GLOBAL FITNESS VALUE FOR EACH ITERATION ELSE FALSE)

        """</span>

        <span class="bp">self</span><span class="p">.</span><span class="n">fitness</span> <span class="o">=</span> <span class="n">fitness</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">P</span> <span class="o">=</span> <span class="n">P</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">n</span> <span class="o">=</span> <span class="n">n</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">w</span> <span class="o">=</span> <span class="n">w</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">c1</span><span class="p">,</span> <span class="bp">self</span><span class="p">.</span><span class="n">c2</span> <span class="o">=</span> <span class="n">c1</span><span class="p">,</span> <span class="n">c2</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">Tmax</span> <span class="o">=</span> <span class="n">Tmax</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">vmax</span> <span class="o">=</span> <span class="n">vmax</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">X</span> <span class="o">=</span> <span class="n">X0</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">bound</span> <span class="o">=</span> <span class="n">bound</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">update_w</span> <span class="o">=</span> <span class="n">update_w</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">update_c1</span> <span class="o">=</span> <span class="n">update_c1</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">update_c2</span> <span class="o">=</span> <span class="n">update_c2</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">update_vmax</span> <span class="o">=</span> <span class="n">update_vmax</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">plot</span> <span class="o">=</span> <span class="n">plot</span>
        <span class="bp">self</span><span class="p">.</span><span class="nb">min</span> <span class="o">=</span> <span class="nb">min</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">verbose</span> <span class="o">=</span> <span class="n">verbose</span>

    <span class="k">def</span> <span class="nf">optimum</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">best</span><span class="p">,</span> <span class="n">particle_x</span><span class="p">):</span>
        <span class="s">"""

        PARAMETERS:

        best: EITHER LOCAL BEST SOLUTION 'pbest' OR GLOBAL BEST SOLUTION 'gbest'

        particle_x: PARTICLE POSITION

        ACTION:

        COMPARE PARTICLE'S CURRENT POSITION EITHER WITH LOCAL BEST OR GLOBAL BEST POSITIONS

            1. IF PROBLEM IS MINIMIZATION (min=TRUE), THEN CHECKS WHETHER FITNESS VALUE OF 'best'

            IS LESS THAN THE FITNESS VALUE OF 'particle_x' AND IF IT IS GREATER, THEN IT

            SUBSTITUTES THE CURRENT PARTICLE POSITION AS THE BEST (GLOBAL OR LOCAL) SOLUTION

            2. IF PROBLEM IS MAXIMIZATION (min=FALSE), THEN CHECKS WHETHER FITNESS VALUE OF 'best'

            IS GREATER THAN THE FITNESS VALUE OF 'particle_x' AND IF IT IS LESS, THEN IT

            SUBSTITUTES THE CURRENT PARTICLE POSITION AS THE BEST (GLOBAL OR LOCAL) SOLUTION

        """</span>

        <span class="k">if</span> <span class="bp">self</span><span class="p">.</span><span class="nb">min</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="p">.</span><span class="n">fitness</span><span class="p">(</span><span class="n">best</span><span class="p">)</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="p">.</span><span class="n">fitness</span><span class="p">(</span><span class="n">particle_x</span><span class="p">):</span>
                <span class="n">best</span> <span class="o">=</span> <span class="n">particle_x</span><span class="p">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="p">.</span><span class="n">fitness</span><span class="p">(</span><span class="n">best</span><span class="p">)</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="p">.</span><span class="n">fitness</span><span class="p">(</span><span class="n">particle_x</span><span class="p">):</span>
                <span class="n">best</span> <span class="o">=</span> <span class="n">particle_x</span><span class="p">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">best</span>

    <span class="k">def</span> <span class="nf">initialize</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="s">"""

        PARAMETERS:

        population: A LIST OF SIZE (P,) WHICH STORES ALL THE SWARM PARTICLE OBJECT

        gbest: GLOBAL BEST POSITION (BEST POSITION IN GROUP) OF SHAPE (n,1)

        ACTION:

        FOR EACH PARTICLE 'i' IN SWARM POPULATION OF SIZE 'P'

            1. IT INITIALIZE POSITION 'X' AND VELOCITY 'V' OF PARTICLE 'i' AND STORES IT IN 'population' LIST

            2. INITIALIZE 'gbest' WITH COPY OF 'ith' PARTICLE'S POSITION 'X' HAVING BEST FITNESS

        """</span>

        <span class="bp">self</span><span class="p">.</span><span class="n">population</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">P</span><span class="p">):</span>
            <span class="bp">self</span><span class="p">.</span><span class="n">population</span><span class="p">.</span><span class="n">append</span><span class="p">(</span>
                <span class="n">Particle</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="bp">self</span><span class="p">.</span><span class="n">n</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="bp">self</span><span class="p">.</span><span class="n">vmax</span><span class="p">,</span> <span class="n">X0</span><span class="o">=</span><span class="bp">self</span><span class="p">.</span><span class="n">X</span><span class="p">,</span> <span class="n">bound</span><span class="o">=</span><span class="bp">self</span><span class="p">.</span><span class="n">bound</span><span class="p">)</span>
            <span class="p">)</span>
            <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="bp">self</span><span class="p">.</span><span class="n">gbest</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">population</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">X</span><span class="p">.</span><span class="n">copy</span><span class="p">()</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="p">.</span><span class="n">gbest</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">optimum</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">gbest</span><span class="p">,</span> <span class="bp">self</span><span class="p">.</span><span class="n">population</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">X</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">update_coeff</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="s">"""

        ACCORDING TO THE PAPER BY M. CLERC AND J. KENNEDY [3], TO DEFINE A STANDARD FOR PARTICLE SWARM OPTIMIZATION,

        THE BEST STATIC PARAMETERS ARE w=0.72984 AND c1 + c2 &gt;= 4. MORE EXACTLY c1 = 2.05 AND c2 = 2.05

        BUT ACCORDING TO [2] SOME OTHER RESEARCHERS THOUGHT THAT c1 DID NOT EQUAL c2 , AND REACHED A CONCLUSION

        c1 = 2.8 FROM EXPERIMENTS.


        BASED ON THESE IDEAS AND INSPIRED BY THE PAPER BY G. SERMPINIS [5],

        [6] SUGGEST THE UPDATION OF THE COEFFICIENTS (c1 AND c2) AS CODED HERE.


        ADDITIONALLY, THE LINEAR DECAY OF THE PARAMETER 'w' WAS INITIALLY PROPOSED BY

        YUHUI AND RUSS Y. H. SHI AND R. C. EBERHART [4].


        CONCEPT OF UPDATING MAXIMUM VECOLITY IS ALSO AVAILABLE IN [2]

        """</span>

        <span class="k">if</span> <span class="bp">self</span><span class="p">.</span><span class="n">update_w</span><span class="p">:</span>
            <span class="bp">self</span><span class="p">.</span><span class="n">w</span> <span class="o">=</span> <span class="mf">0.9</span> <span class="o">-</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">t</span> <span class="o">/</span> <span class="bp">self</span><span class="p">.</span><span class="n">Tmax</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="p">.</span><span class="n">update_c1</span><span class="p">:</span>
            <span class="bp">self</span><span class="p">.</span><span class="n">c1</span> <span class="o">=</span> <span class="mf">3.5</span> <span class="o">-</span> <span class="mi">3</span> <span class="o">*</span> <span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">t</span> <span class="o">/</span> <span class="bp">self</span><span class="p">.</span><span class="n">Tmax</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="p">.</span><span class="n">update_c2</span><span class="p">:</span>
            <span class="bp">self</span><span class="p">.</span><span class="n">c2</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">+</span> <span class="mi">3</span> <span class="o">*</span> <span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">t</span> <span class="o">/</span> <span class="bp">self</span><span class="p">.</span><span class="n">Tmax</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="p">.</span><span class="n">update_vmax</span><span class="p">:</span>
            <span class="bp">self</span><span class="p">.</span><span class="n">vmax</span> <span class="o">=</span> <span class="mf">1.5</span> <span class="o">*</span> <span class="n">np</span><span class="p">.</span><span class="n">exp</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">t</span> <span class="o">/</span> <span class="bp">self</span><span class="p">.</span><span class="n">Tmax</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">move</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="s">"""

        PARAMETERS:

        t: ITERATION NUMBER

        fitness_time: LIST STORING FITNESS (OR COST) VALUE FOR EACH ITERATION

        time: LIST STORING ITERATION NUMBER ([0,1,2,...])

        ACTION:

        AS THE NAME SUGGESTS, THIS FUNCTION MOVES THE PARTICLES BY UPDATING THEIR

        POSITION AND VELOCITY. ALSO BASED ON THE TYPE OF PROBLEM (MAXIMIZATION OR

        MINIMIZATION), IT CALLS THE 'optimum' FUNCTION AND EVALUATE THE 'gbest'

        AND 'pbest' PARAMETERS USING FITNESS VALUE. IT ALSO UPDATE THE COEFFICIENTS.


        NOTE: THIS FUNCTION PRINTS THE GLOBAL FITNESS VALUE FOR EACH ITERATION

        IF THE VERBOSE IS TRUE

        FOLLOW [1] WHERE THE PSO ALGORITHM PSEUDO CODE IS PRESENT IN 'FIGURE-1'

        """</span>

        <span class="bp">self</span><span class="p">.</span><span class="n">t</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">fitness_time</span><span class="p">,</span> <span class="bp">self</span><span class="p">.</span><span class="n">time</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>
        <span class="k">while</span> <span class="bp">self</span><span class="p">.</span><span class="n">t</span> <span class="o">&lt;=</span> <span class="bp">self</span><span class="p">.</span><span class="n">Tmax</span><span class="p">:</span>
            <span class="bp">self</span><span class="p">.</span><span class="n">update_coeff</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">particle</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">.</span><span class="n">population</span><span class="p">:</span>
                <span class="n">particle</span><span class="p">.</span><span class="n">update_velocity</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">w</span><span class="p">,</span> <span class="bp">self</span><span class="p">.</span><span class="n">c1</span><span class="p">,</span> <span class="bp">self</span><span class="p">.</span><span class="n">c2</span><span class="p">,</span> <span class="bp">self</span><span class="p">.</span><span class="n">gbest</span><span class="p">)</span>
                <span class="n">particle</span><span class="p">.</span><span class="n">update_position</span><span class="p">()</span>
                <span class="n">particle</span><span class="p">.</span><span class="n">pbest</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">optimum</span><span class="p">(</span><span class="n">particle</span><span class="p">.</span><span class="n">pbest</span><span class="p">,</span> <span class="n">particle</span><span class="p">.</span><span class="n">X</span><span class="p">)</span>
                <span class="bp">self</span><span class="p">.</span><span class="n">gbest</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">optimum</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">gbest</span><span class="p">,</span> <span class="n">particle</span><span class="p">.</span><span class="n">X</span><span class="p">)</span>
            <span class="bp">self</span><span class="p">.</span><span class="n">fitness_time</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">fitness</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">gbest</span><span class="p">))</span>
            <span class="bp">self</span><span class="p">.</span><span class="n">time</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">t</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="p">.</span><span class="n">verbose</span><span class="p">:</span>
                <span class="k">print</span><span class="p">(</span>
                    <span class="s">"Iteration:  "</span><span class="p">,</span>
                    <span class="bp">self</span><span class="p">.</span><span class="n">t</span><span class="p">,</span>
                    <span class="s">"| best global fitness (cost):"</span><span class="p">,</span>
                    <span class="nb">round</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">fitness</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">gbest</span><span class="p">),</span> <span class="mi">7</span><span class="p">),</span>
                <span class="p">)</span>
            <span class="bp">self</span><span class="p">.</span><span class="n">t</span> <span class="o">+=</span> <span class="mi">1</span>

    <span class="k">def</span> <span class="nf">execute</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="s">"""

        A KIND OF MAIN FUNCTION

        PRINTS THE FINAL SOLUTION

        """</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">initialize</span><span class="p">()</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">move</span><span class="p">()</span>
        <span class="k">print</span><span class="p">(</span><span class="s">"</span><span class="se">\n</span><span class="s">OPTIMUM SOLUTION</span><span class="se">\n</span><span class="s">  &gt;"</span><span class="p">,</span> <span class="n">np</span><span class="p">.</span><span class="nb">round</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">gbest</span><span class="p">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="mi">7</span><span class="p">).</span><span class="n">tolist</span><span class="p">())</span>
        <span class="k">print</span><span class="p">(</span><span class="s">"</span><span class="se">\n</span><span class="s">OPTIMUM FITNESS</span><span class="se">\n</span><span class="s">  &gt;"</span><span class="p">,</span> <span class="n">np</span><span class="p">.</span><span class="nb">round</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">fitness</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">gbest</span><span class="p">),</span> <span class="mi">7</span><span class="p">))</span>
        <span class="k">print</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="p">.</span><span class="n">plot</span><span class="p">:</span>
            <span class="bp">self</span><span class="p">.</span><span class="n">Fplot</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">Fplot</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># PLOTS GLOBAL FITNESS (OR COST) VALUE VS ITERATION GRAPH
</span>
        <span class="n">plt</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">time</span><span class="p">,</span> <span class="bp">self</span><span class="p">.</span><span class="n">fitness_time</span><span class="p">)</span>
        <span class="n">plt</span><span class="p">.</span><span class="n">title</span><span class="p">(</span><span class="s">"Fitness value vs Iteration"</span><span class="p">)</span>
        <span class="n">plt</span><span class="p">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">"Iteration"</span><span class="p">)</span>
        <span class="n">plt</span><span class="p">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">"Fitness value"</span><span class="p">)</span>
        <span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">()</span>


<span class="c1">################################################# END OF PSO CLASS ######################################################################
</span></code></pre></div></div>

<h2 id="fitness-function">Fitness Function</h2>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">fitness_function</span><span class="p">(</span><span class="n">weights</span><span class="p">):</span>
    <span class="n">predictions</span> <span class="o">=</span> <span class="n">X</span> <span class="o">@</span> <span class="n">weights</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">weights</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>  <span class="c1"># w1*X1 + w2*X2 + w3*X3 + w4*X4 + w5
</span>    <span class="n">error</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nb">sum</span><span class="p">((</span><span class="n">Y</span> <span class="o">-</span> <span class="n">predictions</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>       <span class="c1"># MSE hesaplama. Çıkarma işlemi vektörler arasında yapılıyor.
</span>    <span class="k">return</span> <span class="n">error</span>
</code></pre></div></div>

<h1 id="create-pso-model">Create PSO Model</h1>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">pso</span> <span class="o">=</span> <span class="n">PSO</span><span class="p">(</span>
    <span class="n">P</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>                      <span class="c1"># parçacık sayısı
</span>    <span class="n">fitness</span><span class="o">=</span><span class="n">fitness_function</span><span class="p">,</span>   <span class="c1"># uygunluk fonksiyonu
</span>    <span class="c1"># X0=weights,               # başlangıç değerleri. Eğer verilmezse rastgele değerler atanır.
</span>    <span class="n">n</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>                        <span class="c1"># boyut sayısı
</span>    <span class="n">bound</span><span class="o">=</span><span class="p">[</span>
        <span class="p">(</span><span class="o">-</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">),</span>
        <span class="p">(</span><span class="o">-</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">),</span>
        <span class="p">(</span><span class="o">-</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">),</span>
        <span class="p">(</span><span class="o">-</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">),</span>
        <span class="p">(</span><span class="o">-</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">),</span>
    <span class="p">],</span>                          <span class="c1"># arama uzayı sınırları
</span>    <span class="n">Tmax</span><span class="o">=</span><span class="mi">5000</span><span class="p">,</span>                  <span class="c1"># maksimum iterasyon sayısı
</span>    <span class="n">verbose</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>               <span class="c1"># iterasyon bilgilerini yazdır
</span>    <span class="nb">min</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>                   <span class="c1"># uygunluk fonksiyonunu minimize et
</span>    <span class="n">plot</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>                  <span class="c1"># uygunluk fonksiyonunun grafiğini çiz
</span><span class="p">)</span>
</code></pre></div></div>

<h1 id="run-pso">Run PSO</h1>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">pso</span><span class="p">.</span><span class="n">execute</span><span class="p">()</span>
</code></pre></div></div>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Iteration:   0 | best global fitness (cost): 1287415.9750612
Iteration:   1 | best global fitness (cost): 1287415.9750612
Iteration:   2 | best global fitness (cost): 1287415.9750612
Iteration:   3 | best global fitness (cost): 1190029.9669915
Iteration:   4 | best global fitness (cost): 1190029.9669915
Iteration:   5 | best global fitness (cost): 1190029.9669915
Iteration:   6 | best global fitness (cost): 1190029.9669915
Iteration:   7 | best global fitness (cost): 1190029.9669915
Iteration:   8 | best global fitness (cost): 1190029.9669915
...
...
...
Iteration:   4990 | best global fitness (cost): 1112990.1376006
Iteration:   4991 | best global fitness (cost): 1112990.1376006
Iteration:   4992 | best global fitness (cost): 1112990.1376006
Iteration:   4993 | best global fitness (cost): 1112990.1376006
Iteration:   4994 | best global fitness (cost): 1112990.1376006
Iteration:   4995 | best global fitness (cost): 1112990.1376006
Iteration:   4996 | best global fitness (cost): 1112990.1376006
Iteration:   4997 | best global fitness (cost): 1112990.1376006
Iteration:   4998 | best global fitness (cost): 1112990.1376006
Iteration:   4999 | best global fitness (cost): 1112990.1376006
Iteration:   5000 | best global fitness (cost): 1112990.1376006

OPTIMUM SOLUTION
  &gt; [-2e-07, 2e-07, -1.8e-06, 3.8e-06, 70.0972888]

OPTIMUM FITNESS
  &gt; 1112990.1376006
</code></pre></div></div>
<p><img src="/assets/img/projects/pso/fitness_value_vs_iteration.png" alt="fitness value vs iteration" /></p>

  
</article>



  <applause-button
    color=rgb(79,177,186)
    url=http://localhost:4000/projects/2024-10-28-energy-demand-estimation-with-pso-algorithms/ >
  </applause-button>





  
     


  <aside class="about related mt4 mb4" role="complementary">
    
    

<div class="author mt4">
  

  
    


<img
  
    src="/assets/img/pp.jpg"
    srcset="/assets/img/pp.jpg 1x,/assets/img/pp.jpg 2x"
    
  
  alt="Metehan Özdeniz"
  class="avatar"
  
  width="120"
  height="120"
  loading="lazy"
/>

  

  
  
  <h2  class="page-title hr-bottom">
    About
  </h2>

  <p>Computer Engineer Candidate - AI &amp; Software Developer</p>


  <div class="sidebar-social">
    <span class="sr-only">Social:</span>
<ul>
  
    
      



  

  
  
  
  

  

  

  <li>
    <a href="https://x.com/metehanozdeniz" title="X" class="no-mark-external">
      <span class="icon-twitter"></span>
      <span class="sr-only">X</span>
    </a>
  </li>


    
      



  

  
  
  
  

  

  

  <li>
    <a href="https://github.com/metehanozdeniz" title="GitHub" class="no-mark-external">
      <span class="icon-github"></span>
      <span class="sr-only">GitHub</span>
    </a>
  </li>


    
      



  

  
  
  
  

  

  

  <li>
    <a href="mailto:contact@metehanozdeniz.com" title="Email" class="no-mark-external">
      <span class="icon-mail"></span>
      <span class="sr-only">Email</span>
    </a>
  </li>


    
      



  

  
  
  
  

  

  

  <li>
    <a href="https://instagram.com/metehanozdeniz" title="Instagram" class="no-mark-external">
      <span class="icon-instagram"></span>
      <span class="sr-only">Instagram</span>
    </a>
  </li>


    
      



  

  
  
  
  

  

  

  <li>
    <a href="https://www.linkedin.com/in/metehan-özdeniz" title="LinkedIn" class="no-mark-external">
      <span class="icon-linkedin2"></span>
      <span class="sr-only">LinkedIn</span>
    </a>
  </li>


    
      



  

  
  
  
  

  

  

  <li>
    <a href="/resume.pdf" title="Download Resume" class="no-mark-external">
      <span class="icon-file-pdf"></span>
      <span class="sr-only">Download Resume</span>
    </a>
  </li>


    
  
</ul>

  </div>
</div>

  </aside>


  

  
  

  
    


  <aside class="related mb4" role="complementary">  <h2 class="hr-bottom">Related Posts</h2>  <ul class="related-posts">                  <li class="h4">  <a href="/machine-learning/2024-09-23-naive-bayes/" class="flip-title"><span>Naive Bayes</span></a>      <time class="faded fine" datetime="2024-09-23T00:00:00+03:00">23 Sep 2024</time>        <span class="clap-count" data-url="http://localhost:4000/machine-learning/2024-09-23-naive-bayes/"></span>  </li>                        <li class="h4">  <a href="/machine-learning/2024-09-21-support-vector-machine/" class="flip-title"><span>Support Vector Machine (SVM)</span></a>      <time class="faded fine" datetime="2024-09-21T00:00:00+03:00">21 Sep 2024</time>        <span class="clap-count" data-url="http://localhost:4000/machine-learning/2024-09-21-support-vector-machine/"></span>  </li>                        <li class="h4">  <a href="/machine-learning/2024-09-07-k-nn/" class="flip-title"><span>K-NN (K-Nearest Neighbors)</span></a>      <time class="faded fine" datetime="2024-09-07T00:00:00+03:00">07 Sep 2024</time>        <span class="clap-count" data-url="http://localhost:4000/machine-learning/2024-09-07-k-nn/"></span>  </li>            </ul></aside>

  

  
  

  
    
<aside class="comments related" role="complementary">
  <h2 class="hr-bottom">Comments</h2>
  <script src="https://giscus.app/client.js"
        data-repo="metehanozdeniz/metehanozdeniz.github.io"
        data-repo-id="R_kgDOKY9pBQ"
        data-category="Comments"
        data-category-id="DIC_kwDOKY9pBc4CZqUD"
        data-mapping="pathname"
        data-strict="0"
        data-reactions-enabled="1"
        data-emit-metadata="1"
        data-input-position="top"
        data-theme="noborder_dark"
        data-lang="en"
        crossorigin="anonymous"
        async>
</script>
</aside>


  


  
<footer class="content" role="contentinfo">
  <hr/>
  
    <p><small class="copyright">© 2024. All rights reserved.
</small></p>
  
  
    <p><small>Powered by <a class="external" href="https://metehanozdeniz.github.io/">Metehan Özdeniz</a></small></p>
  <hr class="sr-only"/>
</footer>


</main>

  <hy-drawer
  id="_drawer"
  class=""
  side="left"
  threshold="10"
  noscroll
  
>
  <header id="_sidebar" class="sidebar" role="banner">
    <!-- 



 -->
<div id="tsparticles"></div>

<!-- <div class="sidebar-bg sidebar-overlay" style="background-color:rgb(0,0,0);background-image:url(/assets/img/sidebar-bg.gif)"></div> -->
    <div class="sidebar-sticky no-fouc">
  <div class="sidebar-about">
    
      <a class="no-hover" href="/" tabindex="-1">
        <img src="/assets/img/pp.jpg" class="avatar" alt="Metehan Özdeniz" width="120" height="120" loading="lazy" />
      </a>
    
    <a class="sidebar-title" href="/"><h2 class="h1">Metehan Özdeniz</h2></a>
    
    
      <p class="">
        Gerçekliğin ardındaki sistemle oynayan birisi.

      </p>
    
  </div>

  <nav class="sidebar-nav heading" role="navigation">
    <span class="sr-only">Navigation:</span>
<ul>
  
    
      
      <li>
        <a
          id="_drawer--opened"
          href="/"
          class="sidebar-nav-item "
          
        >
          Blog
        </a>
      </li>
    
      
      <li>
        <a
          
          href="/projects/"
          class="sidebar-nav-item "
          
        >
          My Projects
        </a>
      </li>
    
      
      <li>
        <a
          
          href="/machine-learning/"
          class="sidebar-nav-item "
          
        >
          Machine Learning
        </a>
      </li>
    
      
      <li>
        <a
          
          href="/software/"
          class="sidebar-nav-item "
          
        >
          Software
        </a>
      </li>
    
      
      <li>
        <a
          
          href="/about/"
          class="sidebar-nav-item "
          
        >
          About Me
        </a>
      </li>
    
  
</ul>

  </nav>

  
  <div class="sidebar-social">
    <span class="sr-only">Social:</span>
<ul>
  
    
      



  

  
  
  
  

  

  

  <li>
    <a href="https://x.com/metehanozdeniz" title="X" class="no-mark-external">
      <span class="icon-twitter"></span>
      <span class="sr-only">X</span>
    </a>
  </li>


    
      



  

  
  
  
  

  

  

  <li>
    <a href="https://github.com/metehanozdeniz" title="GitHub" class="no-mark-external">
      <span class="icon-github"></span>
      <span class="sr-only">GitHub</span>
    </a>
  </li>


    
      



  

  
  
  
  

  

  

  <li>
    <a href="mailto:contact@metehanozdeniz.com" title="Email" class="no-mark-external">
      <span class="icon-mail"></span>
      <span class="sr-only">Email</span>
    </a>
  </li>


    
      



  

  
  
  
  

  

  

  <li>
    <a href="https://instagram.com/metehanozdeniz" title="Instagram" class="no-mark-external">
      <span class="icon-instagram"></span>
      <span class="sr-only">Instagram</span>
    </a>
  </li>


    
      



  

  
  
  
  

  

  

  <li>
    <a href="https://www.linkedin.com/in/metehan-özdeniz" title="LinkedIn" class="no-mark-external">
      <span class="icon-linkedin2"></span>
      <span class="sr-only">LinkedIn</span>
    </a>
  </li>


    
      



  

  
  
  
  

  

  

  <li>
    <a href="/resume.pdf" title="Download Resume" class="no-mark-external">
      <span class="icon-file-pdf"></span>
      <span class="sr-only">Download Resume</span>
    </a>
  </li>


    
  
</ul>

  </div>
</div>
  </header>
</hy-drawer>
<hr class="sr-only" hidden />

</hy-push-state>


  <!--[if gt IE 10]><!---->
  <script nomodule>(()=>{var t,n=document.createElement("script");!("noModule"in n)&&"onbeforeload"in n&&(t=!1,document.addEventListener("beforeload",function(e){if(e.target===n)t=!0;else if(!e.target.hasAttribute("nomodule")||!t)return;e.preventDefault()},!0),n.type="module",n.src=".",document.head.appendChild(n),n.remove())})();
</script>
  <script src="/assets/js/hydejack-9.2.0.js" type="module"></script>
  <script src="/assets/js/LEGACY-hydejack-9.2.0.js" nomodule defer></script>
  
  <script src="/assets/js/lightbox.js"></script>


<script>
  document
    .getElementById("_pushState")
    .addEventListener("hy-push-state-load", function () {
      get_clap_count();
      addLoadEvent(initLightbox)
    });
</script>

<script src="https://cdn.jsdelivr.net/npm/tsparticles@2.0.6/tsparticles.bundle.min.js"></script>
<script src="/assets/js/tsparticles.js"></script>
  
  <script>!function(w, d) {
    w.ga=w.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;

    /**/
      if (navigator.CookiesOK) {
        ga('create', 'G-CB4287NP8H', 'auto');
      } else if (d.cookie.indexOf("hy--cookies-ok=true") > -1) {
        ga('create', 'G-CB4287NP8H', {
          'storage': 'none',
          'clientId': localStorage ? localStorage.getItem('ga--client-id') : undefined
        });
      } else {
        ga('create', 'G-CB4287NP8H', {
          'storage': 'none'
        });
        ga('set', 'forceSSL', true);
        ga('set', 'anonymizeIp', true);
      }
    /**/

    var pushStateEl = d.getElementById('_pushState');
    var timeoutId;
    pushStateEl.addEventListener('hy-push-state-load', function() {
      w.clearTimeout(timeoutId);
      timeoutId = w.setTimeout(function() {
        ga('set', 'page', w.location.pathname);
        ga('send', 'pageview');
      }, 500);
    });

    d.addEventListener('hy--cookies-ok', function () {
      w.ga(function(tracker) {
        w.ga("set", "anonymizeIp", undefined);
        localStorage && localStorage.setItem("ga--client-id", tracker.get("clientId"));
      });
    });

    w.loadJSDeferred('https://www.google-analytics.com/analytics.js');
  }(window, document);</script>


<!--<![endif]-->
  



<div hidden>
  
  <h2 class="sr-only">Templates (for web app):</h2>

  <template id="_animation-template">
  <div class="animation-main fixed-top">
    <nav id="breadcrumbs" class="screen-only"><ul>
  
  
</ul></nav>
    <div class="content">
      <div class="page"></div>
    </div>
  </div>
</template>

  <template id="_loading-template">
  <div class="loading nav-btn fr">
    <span class="sr-only">Loading...</span>
    <span class="icon-cog"></span>
  </div>
</template>

  <template id="_error-template">
  <div class="page">
    <h1 class="page-title">Error</h1>
    
    
    <p class="lead">
      Sorry, but something went wrong. <a class="this-link" href=""></a>.

    </p>
  </div>
</template>

  <template id="_permalink-template">
  <a href="#" class="permalink">
    <span class="sr-only">Permalink</span>
    <span class="content-hash"></span>
  </a>
</template>

  
    <template id="_dark-mode-template">
  <button id="_dark-mode" class="nav-btn no-hover" >
    <span class="sr-only">Dark Mode</span>
    <span class="icon-brightness-contrast"></span>
  </button>
</template>

  
</div>


</body>
</html>
